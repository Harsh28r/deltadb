
> deltayards-crm@1.0.0 start
> node server.js

[dotenv@17.2.1] injecting env (18) from .env -- tip: ğŸ“¡ auto-backup env with Radar: https://dotenvx.com/radar
âœ… Reminder service cron jobs initialized
âœ… Real-time system initialized
MONGO_URI: mongodb+srv://db1:123456g@cluster0.fcyiy3l.mongodb.net/deltacrm?retryWrites=true&w=majority&appName=Cluster0
Starting MongoDB connection...
MongoDB connection attempt 1/5
(node:7496) [MONGOOSE] Warning: Duplicate schema index on {"name":1} found. This is often due to declaring an index using both "index: true" and "schema.index()". Please remove the duplicate index definition.
(Use `node --trace-warnings ...` to show where the warning was created)
Mongoose connected to MongoDB
MongoDB connected successfully
âœ… Redis connected successfully
ğŸ”„ Redis ping successful
ğŸš€ Creating optimized database indexes for large datasets...
ğŸ“Š Creating indexes for User...
âœ… Created index for User: { email: 1 }
âœ… Created index for User: { email: 1, isActive: 1 }
âœ… Created index for User: { role: 1, level: 1 }
âœ… Created index for User: { level: 1, isActive: 1 }
âœ… Created index for User: { role: 1, isActive: 1 }
âœ… Created index for User: { 'restrictions.allowedProjects': 1 }
âœ… Created index for User: { 'restrictions.deniedProjects': 1 }
âœ… Created index for User: { role: 1, level: 1, isActive: 1, createdAt: -1 }
âœ… Created index for User: { email: 1, role: 1, isActive: 1 }
âœ… Created index for User: { name: 'text', email: 'text' }
ğŸ“Š Creating indexes for Lead...
â„¹ï¸ Index already exists for Lead: user_createdAt
âœ… Created index for Lead: { project: 1, createdAt: -1 }
â„¹ï¸ Index already exists for Lead: currentStatus
âœ… Created index for Lead: { user: 1, project: 1 }
âœ… Created index for Lead: { project: 1, currentStatus: 1 }
âœ… Created index for Lead: { channelPartner: 1, createdAt: -1 }
â„¹ï¸ Index already exists for Lead: cpSourcingId_createdAt
âœ… Created index for Lead: { isActive: 1, createdAt: -1 }
âœ… Created index for Lead: { createdBy: 1, createdAt: -1 }
âœ… Created index for Lead: { updatedBy: 1, updatedAt: -1 }
âœ… Created index for Lead: { project: 1, currentStatus: 1, isActive: 1, createdAt: -1 }
âœ… Created index for Lead: { user: 1, currentStatus: 1, isActive: 1 }
âœ… Created index for Lead: { channelPartner: 1, currentStatus: 1, isActive: 1 }
âœ… Created index for Lead: { 'statusHistory.changedAt': -1 }
âœ… Created index for Lead: { leadSource: 1, createdAt: -1 }
âœ… Created index for Lead: { leadSource: 1, currentStatus: 1 }
ğŸ“Š Creating indexes for Project...
â„¹ï¸ Index already exists for Project: name
â„¹ï¸ Index already exists for Project: owner
â„¹ï¸ Index already exists for Project: members
â„¹ï¸ Index already exists for Project: managers
âœ… Created index for Project: { location: 1 }
âœ… Created index for Project: { developBy: 1 }
âœ… Created index for Project: { owner: 1, createdAt: -1 }
âœ… Created index for Project: { location: 1, createdAt: -1 }
âœ… Created index for Project: { name: 'text', location: 'text', developBy: 'text' }
ğŸ“Š Creating indexes for Task...
âœ… Created index for Task: { assignedTo: 1, createdAt: -1 }
âœ… Created index for Task: { createdBy: 1, createdAt: -1 }
âœ… Created index for Task: { project: 1, createdAt: -1 }
âœ… Created index for Task: { project: 1, status: 1 }
âœ… Created index for Task: { priority: 1, status: 1 }
âœ… Created index for Task: { status: 1, dueDate: 1 }
âœ… Created index for Task: { dueDate: 1, status: 1 }
âœ… Created index for Task: { dueDate: 1, assignedTo: 1 }
âœ… Created index for Task: { assignedTo: 1, status: 1, priority: 1 }
âœ… Created index for Task: { project: 1, assignedTo: 1, status: 1 }
ğŸ“Š Creating indexes for Notification...
âœ… Created index for Notification: { recipient: 1, createdAt: -1 }
âœ… Created index for Notification: { recipient: 1, read: 1, createdAt: -1 }
âœ… Created index for Notification: { recipient: 1, read: 1 }
âœ… Created index for Notification: { type: 1, createdAt: -1 }
âœ… Created index for Notification: { recipient: 1, type: 1 }
âœ… Created index for Notification: { createdAt: 1 }
âœ… Created index for Notification: { recipient: 1, priority: 1, read: 1 }
â„¹ï¸ TTL index already exists for Notification
ğŸ“Š Creating indexes for Reminder...
âœ… Created index for Reminder: { user: 1, reminderDate: 1 }
âœ… Created index for Reminder: { user: 1, isCompleted: 1 }
âœ… Created index for Reminder: { reminderDate: 1, isCompleted: 1 }
âœ… Created index for Reminder: { task: 1, reminderDate: 1 }
âœ… Created index for Reminder: { reminderDate: 1, isCompleted: 1, isActive: 1 }
âœ… Created index for Reminder: { isRecurring: 1, reminderDate: 1 }
ğŸ“Š Creating indexes for LeadActivity...
âœ… Created index for LeadActivity: { lead: 1, createdAt: -1 }
âœ… Created index for LeadActivity: { user: 1, createdAt: -1 }
âœ… Created index for LeadActivity: { activityType: 1, createdAt: -1 }
âœ… Created index for LeadActivity: { lead: 1, activityType: 1, createdAt: -1 }
âœ… Created index for LeadActivity: { user: 1, activityType: 1, createdAt: -1 }
âœ… Created index for LeadActivity: { createdAt: 1 }
â„¹ï¸ TTL index already exists for LeadActivity
ğŸ“Š Creating indexes for UserReporting...
âœ… Created index for UserReporting: { user: 1 }
âœ… Created index for UserReporting: { level: 1 }
â„¹ï¸ Index already exists for UserReporting: reportsTo.user
âœ… Created index for UserReporting: { 'reportsTo.teamType': 1 }
âœ… Created index for UserReporting: { user: 1, level: 1 }
âœ… Created index for UserReporting: { level: 1, 'reportsTo.user': 1 }
âœ… Database optimization completed
ğŸ“ˆ Database Optimization Statistics:
  - Indexes created: 62
  - Schemas optimized: 0
  - Query optimizations: 0
âœ… Database optimizations applied
ğŸš¨ UNCAUGHT EXCEPTION! ğŸ’¥ Shutting down...
Error: listen EADDRINUSE: address already in use :::5000
Stack: Error: listen EADDRINUSE: address already in use :::5000
    at Server.setupListenHandle [as _listen2] (node:net:1940:16)
    at listenInCluster (node:net:1997:12)
    at Server.listen (node:net:2102:7)
    at startServer (C:\Users\harshgupta\Documents\Crmbackend\deltadb\server.js:372:14)
    at process.processTicksAndRejections (node:internal/process/task_queues:105:5)
